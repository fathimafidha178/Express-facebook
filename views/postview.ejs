<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Facebook Navbar with Sidebar</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css" rel="stylesheet" />

  <style>
    .icon-spacing {
      margin: 0 20px;
    }

    .notification-badge {

      font-size: 10px;
      border-radius: 50%;
      padding: 2px 6px;
      position: absolute;
      top: -5px;
      right: -10px;
    }

    .form-control {
      border-radius: 20px;
    }

    .sidebar-item {
      display: flex;
      align-items: center;
      padding: 8px 10px;
      border-radius: 10px;
      cursor: pointer;
    }

    .sidebar-item img {
      width: 24px;
      margin-right: 10px;
    }

    .sidebar-item:hover {
      background-color: #f0f2f5;
    }

    .sidebar {
      width: 260px;
    }

    .content-row {
      margin-top: 5px;
    }
  </style>
</head>

<body>


  <nav class="bg-white shadow-sm px-3 py-2">
    <div class="container-fluid">
      <div class="row align-items-center">

        <!-- //navbar// -->

        <div class="col-md-4 d-flex align-items-center ">
          <img src="fblogo.png" alt="Facebook" width="40" />
          <div class="input-group ms-2">
            <span class="input-group-text bg-white border-0">
              <img src="search.png" width="18px" alt="Search" />
            </span>
            <input type="text" class="form-control border-0" placeholder="Search Facebook" />
          </div>
        </div>

        <!-- //nav icons// -->

        <div class="col-md-4 d-flex justify-content-center">
          <img src="home.png" class="icon-spacing" width="30px" alt="Home" />
          <img src="reel.png" class="icon-spacing" width="30px" alt="Reel" />
          <img src="marketplace.png" class="icon-spacing" width="20" alt="Marketplace" />
          <img src="group.png" class="icon-spacing" width="40px" alt="Group" />
          <img src="game.png" class="icon-spacing" width="40px" alt="Game" />
        </div>

        <div class="col-md-4 d-flex justify-content-end align-items-center">
          <div class="position-relative me-3">
            <a href="/chat_users">
              <img src="messenger.png" width="30px" alt="Messenger" />
            </a>

          </div>
          <div class="position-relative me-3">
            <img src="bell.png" width="30px" alt="Notifications" />
          </div>
          <div class="position-relative me-3">
            <a href="/profile">
              <img src="/<%= user.photo %>" class="rounded-circle" style="width: 40px; height: 40px;" />
            </a>
          </div>

          <div class="position-relative me-3">
            <a href="/logout">
              <img src="logout.png" width="20px" /></a>
          </div>
        </div>
      </div>
    </div>
  </nav>

  <!-- //sidebar-items// -->

  <div class="container-fluid content-row">
    <div class="row">
      <div class="col-md-3 sidebar">

        <div class="sidebar-item">
          <img src="/<%= user.photo %>" class="rounded-circle" style="width: 40px; height: 40px;" />
          <span>
            <%= user.firstname %>
              <%= user.surname %>
          </span>

        </div>
        <div class="sidebar-item">
          <img src="meta.png" />
          <span>Meta AI</span>
        </div>
        <div class="sidebar-item">
          <img src="friend.png" />
          <span>Friends</span>
        </div>
        <div class="sidebar-item">
          <img src="dashboard.png" />
          <span>Professional dashboard</span>
        </div>
        <div class="sidebar-item">
          <img src="feeds.png" />
          <span>Feeds</span>
        </div>
        <div class="sidebar-item">
          <img src="group.png" />
          <span>Groups</span>
        </div>
        <div class="sidebar-item">
          <img src="marketplace.png" />
          <span>Marketplace</span>
        </div>
        <div class="sidebar-item">
          <img src="video.png" />
          <span>Video</span>
        </div>
        <div class="sidebar-item">
          <img src="memories.png" />
          <span>Memories</span>
        </div>
        <div class="sidebar-item">
          <img src="bookmark.png" />
          <span>Saved</span>
        </div>
      </div>

      <!-- //post upload// -->

      <div class="col-md-9">

        <h3>What's on your mind?</h3>

        <form action="/postview_post" method="POST" enctype="multipart/form-data" class="mb-4">
          <textarea name="content" class="form-control mb-2" placeholder="Write something..." required></textarea>
          <input type="file" name="file" class="form-control mb-2" />
          <button type="submit" class="btn btn-primary">Post</button>
        </form>
        <% posts.forEach(post=> { %>
          <div class="post mb-4 border p-3 rounded">

            <!-- User Info -->
            <div class="d-flex align-items-center mb-2">
              <a href="/profile/<%= post.user._id %>">
                <img src="/<%= post.user.photo %>" class="rounded-circle me-2"
                  style="width: 30px; height: 30px; object-fit: cover;" />
              </a>
              <div>
                <a href="/profile/<%= post.user._id %>" class="text-decoration-none fw-bold text-dark">
                  <%= post.user.firstname %>
                    <%= post.user.surname %>
                </a>
                <div class="text-muted" style="font-size: 13px;">
                  <%= new Date(post.date).toLocaleString() %>
                </div>
              </div>
            </div>

            <!-- Post Content -->
            <p>
              <%= post.content %>
            </p>

            <% if (post.img) { %>
              <img src="/<%= post.img %>" class="img-fluid rounded mb-2" style="max-width: 1500px; height: 500px;" />
              <% } %>

                <!-- Likes -->
                <p><strong>
                    <%= post.likes %> Likes
                  </strong></p>


                <div class="d-flex gap-2 mt-3">
                  <form action="/like_post" method="POST">
                    <input type="hidden" name="postId" value="<%= post._id %>" />
                    <button type="submit" class="btn btn-outline-danger btn-sm">‚ù§Ô∏è </button>
                  </form>

                  <form action="/share_post" method="POST">
                    <input type="hidden" name="postId" value="<%= post._id %>" />
                    <button type="submit" class="btn btn-outline-success btn-sm">üîÅ </button>


                  </form>

                  <!-- <a href="/likes/<%= post._id %>" class="btn btn-link btn-sm">View Likes</a> -->

                </div>

              <!-- //comment  -->
                <form action="/add_comment" method="POST" class="mt-3">
                  <input type="hidden" name="postId" value="<%= post._id %>" />
                  <div class="input-group">
                    <input type="text" name="comment" class="form-control" placeholder="Write a comment..." required />
                    <button type="submit" class="btn btn-secondary">Comment</button>
                  </div>
                </form>

                <!-- //showcmments// -->

                <div class="comments mt-3">
                  <% if (post.comments && post.comments.length> 0) { %>
                    <% post.comments.slice(0, 3).forEach(comment=> { %>
                      <div class="border rounded p-2 mb-2 bg-light">
                        <strong>
                          <%= comment.user?.firstname || 'Unknown' %>:
                        </strong>
                        <%= comment.comment %>
                      </div>
                      <% }) %>

                        <% if (post.comments.length> 3) { %>
                          <p class="text-muted">
                            <%= post.comments.length %> comments
                          </p>
                          <% } %>
                            <% } else { %>
                              <p class="text-muted">No comments yet.</p>
                              <% } %>
                </div>

                <!-- Read More Modal -->
                <button type="button" class="btn btn-primary mt-3" data-bs-toggle="modal"
                  data-bs-target="#modal-<%= post._id %>">
                  Read more...
                </button>


                <div class="modal fade" id="modal-<%= post._id %>" tabindex="-1"
                  aria-labelledby="modalLabel-<%= post._id %>" aria-hidden="true">
                  <div class="modal-dialog modal-lg">
                    <div class="modal-content">
                      <div class="modal-header">
                        <h5 class="modal-title" id="modalLabel-<%= post._id %>"></h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                      </div>

                      <div class="modal-body">


                        <h6>All Comments</h6>

                        <% post.comments.forEach(comment=> { %>
                          <div class="border rounded p-2 mb-2 bg-light">
                            <strong>
                              <%= comment.user?.firstname || 'Unknown' %>:
                            </strong>
                            <%= comment.comment %>
                          </div>
                          <% }) %>
                      </div>
                    </div>
                  </div>
                </div>


          </div>
          <% }) %>
      </div>

    </div>  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>