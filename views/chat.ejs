
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Chat with <%= other.firstname %></title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    .chat-box { max-width: 700px; margin: auto; margin-top: 30px; }
    .message.me { text-align: right; background: #dcf8c6; padding: 10px; border-radius: 10px; margin: 5px 0; }
    .message.other { text-align: left; background: #eee; padding: 10px; border-radius: 10px; margin: 5px 0; }
    .timestamp { font-size: 0.75rem; color: #666; }
  </style>
</head>
<body>

<div class="chat-box">
  <h4>Chat with <%= other.firstname %> <%= other.surname %></h4>
  <div class="border p-3 mb-3" style="max-height: 400px; overflow-y: auto;">
    <% messages.forEach(msg => { %>
      <div class="message <%= msg.sender._id.toString() === me._id.toString() ? 'me' : 'other' %>">
        <div><strong><%= msg.sender.firstname %>:</strong></div>
        <div><%= msg.content %></div>
        <div class="timestamp"><%= new Date(msg.date).toLocaleString() %></div>
      </div>
    <% }) %>
  </div>

  <form action="/send_message" method="POST">
    <input type="hidden" name="receiverId" value="<%= other._id %>">
    <div class="input-group">
      <input type="text" name="message" class="form-control" placeholder="Type your message..." required>
      <button class="btn btn-primary">Send</button>
    </div>
  </form>
</div>

</body>
</html>
